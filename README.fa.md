# ๐ ุงุณฺฉุฑูพุช ูุงุฑูุงู ุงูู ุจุฑุง ุณุฑูุฑูุง ุฏุงุฎู ุงุฑุงู
## [Click to view in English](README.md)

ุงู ุงุณฺฉุฑูพุช ฺฉ ุงุจุฒุงุฑ ุณุงุฏู ู ุฎูุฏฺฉุงุฑ ุจุฑุง **ุงูุฒุงุด ุงููุช ุณุฑูุฑูุง ุฏุงุฎู ุงุฑุงู** ุงุณุช ฺฉู ุจุง ุงุฌุฑุง ุขูุ ููุท ฺฉ ุณุฑูุฑ ุฎุงุฑุฌ ูุดุฎุต (ูุซูุงู ุขููุงู) ูโุชูุงูุฏ ุจู ุณุฑูุฑ ุงุฑุงู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ ู ูููโ ุฏุณุชุฑุณโูุง ุฏฺฏุฑ (ุงุฒ ุฌููู ฺฉุงุฑุจุฑุงู ุฏุงุฎู ุงุฑุงู) **ูุณุฏูุฏ ูโุดููุฏ**.

ุงู ุงุณฺฉุฑูพุช ููุงุณุจ ูพุฑูฺูโูุง ูุซู:

- โ **Rathole v2**
- โ **Backhaul**
- โ **Xray / V2ray**
- โ ุง ูุฑ ุชููู TCP ุฏฺฏุฑ

## โจ ูฺฺฏโูุง

- ุงููุช ุจุงูุง ุจุง ุจุณุชู ฺฉุงูู ูุฑูุฏ ู ุฎุฑูุฌโูุง
- ูพุดุชุจุงู ุงุฒ ุชุนุฏุงุฏ ุฏูุฎูุงู ูพูุฑุช (ฑ ุชุง ุจโููุงุช)
- ุงูฺฉุงู ุชุนุฑู ููุท ฺฉ IP ูุฌุงุฒ ุฎุงุฑุฌ
- ุบุฑูุนุงู ฺฉุฑุฏู ูพุงุณุฎ ุจู ูพูฺฏ (ูุฎู ูุงูุฏู)
- ุฐุฎุฑู ุฎูุฏฺฉุงุฑ ููุงูู ูุงุฑูุงู ุจุฑุง ุจุนุฏ ุงุฒ ุฑุจูุช

## โ๏ธ ูพุดโูุงุฒูุง

- ุณุฑูุฑ Ubuntu ุง Debian
- ุฏุณุชุฑุณ `root`
- ูพฺฉุฌ `iptables` ู `iptables-persistent` (ุฏุฑ ุญู ุงุฌุฑุง ูุตุจ ูโุดูุฏ)

## ๐ ูุญูู ุงุณุชูุงุฏู

### 1. ุฏุฑุงูุช ุงุณฺฉุฑูพุช

```bash
wget https://raw.githubusercontent.com/power0matin/Iran-Firewall-Hardening-Script/main/universal-firewall.sh
chmod +x universal-firewall.sh
````

### 2. ูุฑุงุด ุชูุธูุงุช ุงุณฺฉุฑูพุช

ุงุณฺฉุฑูพุช ุฑุง ุจุง ูุฑุงุดฺฏุฑ ุฏูุฎูุงู ุจุงุฒ ฺฉูุฏ:

```bash
nano universal-firewall.sh
```

ุฏุฑ ุงุจุชุฏุง ูุงูุ ุงู ููุงุฏุฑ ุฑุง ุจู ุฏูุฎูุงู ุชุบุฑ ุฏูุฏ:

```bash
foreign_server_ip="1.2.3.4"       # ุขโูพ ุณุฑูุฑ ุฎุงุฑุฌ
allowed_ports=(2053 10000 10001)  # ูุณุช ูพูุฑุชโูุง ฺฉู ุณุฑูุฑ ุฎุงุฑุฌ ุงุฌุงุฒู ุฏุณุชุฑุณ ุฏุงุฑุฏ
```

ูุฑ ุชุนุฏุงุฏ ูพูุฑุช ูโุชูุงูุฏ ุงุถุงูู ุง ุญุฐู ฺฉูุฏ.

### 3. ุงุฌุฑุง ุงุณฺฉุฑูพุช

```bash
sudo ./universal-firewall.sh
```


## ๐ ุจุงุฒฺฏุฑุฏุงู ุชูุธูุงุช ูุงุฑูุงู (ุงุณฺฉุฑูพุช ุฑุณุช)

ุงฺฏุฑ ุฎูุงุณุชุฏ ุชูุงู ุชุบุฑุงุช ูุงุฑูุงู ุฑุง ุญุฐู ฺฉูุฏ ู ุณุฑูุฑ ุฑุง ุจู ุญุงูุช ฺฉุงููุงู ุจุงุฒ ู ุจุฏูู ูุญุฏูุฏุช ุจุฑฺฏุฑุฏุงูุฏุ ุงุฒ ุงุณฺฉุฑูพุช ุฑุณุช ุงุณุชูุงุฏู ฺฉูุฏ:

1. ุฏุฑุงูุช ุง ุงุฌุงุฏ ูุงู `reset-firewall.sh`:

```bash
wget https://raw.githubusercontent.com/power0matin/Iran-Firewall-Hardening-Script/main/reset-firewall.sh
chmod +x reset-firewall.sh
```

2. ุงุฌุฑุง ุงุณฺฉุฑูพุช:

```bash
sudo ./reset-firewall.sh
```

ุงู ุงุณฺฉุฑูพุช:

* ุชูุงู ููุงูู `iptables` ุฑุง ุญุฐู (flush) ูโฺฉูุฏ
* ุณุงุณุชโูุง ูพุดโูุฑุถ ุฑุง ุฑู ACCEPT (ุงุฌุงุฒู ฺฉุงูู) ุชูุธู ูโฺฉูุฏ
* ูพุงุณุฎ ุจู ูพูฺฏ (ICMP) ุฑุง ูุนุงู ูโฺฉูุฏ
* ููุงูู ุฐุฎุฑูโุดุฏู ุฏุฑ `iptables-persistent` ุฑุง ูพุงฺฉ ูโฺฉูุฏ
* ุฏุฑ ุตูุฑุช ูุงุฒุ ูพฺฉุฌ `iptables-persistent` ุฑุง ุญุฐู ูโฺฉูุฏ ุชุง ููุงูู ูุฏู ุฏูุจุงุฑู ุจุงุฑฺฏุฐุงุฑ ูุดููุฏ


## ๐งช ุฎุฑูุฌ ููููู

```bash
[*] Flushing old iptables rules...
[*] Allowing localhost traffic...
[*] Applying firewall rules for foreign_server_ip: 1.2.3.4
 - Allowing port 2053 for 1.2.3.4
 - Allowing port 10000 for 1.2.3.4
 - Allowing port 10001 for 1.2.3.4
[*] Blocking all other traffic...
[*] Disabling ping response (ICMP)...
[*] Installing iptables-persistent...
[โ] Done. Only these ports are open to 1.2.3.4: 2053 10000 10001
```


## โ๏ธ ูุดุฏุงุฑ ููู

* ุงฺฏุฑ `foreign_server_ip` ุฑุง ุงุดุชุจุงู ูุงุฑุฏ ฺฉูุฏ ุง ูพูุฑุชโูุง ุฑุง ุบูุท ุชูุธู ฺฉูุฏุ **ููฺฉู ุงุณุช ุฏุณุชุฑุณ SSH ุจู ุณุฑูุฑ ูุทุน ุดูุฏ.**
* ูุจู ุงุฒ ุงุฌุฑุง ููุงุ ุงุชุตุงู ุชููู ุฑุง ุงุฒ ุณุฑูุฑ ุฎุงุฑุฌ ุชุณุช ฺฉูุฏ.
* ุงฺฏุฑ ูุงุฒ ุจู ุฏุณุชุฑุณ DNS ุง NTP ุฏุงุฑุฏุ ุจุงุฏ ูพูุฑุชโูุง `53` ู `123` ุฑุง ุฏุฑ ุฎุฑูุฌ ุจุงุฒ ุจฺฏุฐุงุฑุฏ.
* **ุงุณฺฉุฑูพุช ุฑุณุชุ ุชูุงู ูุญุฏูุฏุชโูุง ูุงุฑูุงู ุฑุง ุญุฐู ูโฺฉูุฏ ู ุณุฑูุฑ ุฑุง ฺฉุงููุงู ุจุงุฒ ูโฺฉูุฏ** โ ููุท ุฏุฑ ุตูุฑุช ูุงุฒ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ.


## ๐ ูุฌูุฒ ุงุณุชูุงุฏู

ุงู ูพุฑูฺู ุชุญุช ูุงุณูุณ MIT ููุชุดุฑ ุดุฏู ู ุงุณุชูุงุฏู ุงุฒ ุขู ุฏุฑ ูุฑ ููุน ูพุฑูฺู (ุดุฎุต ุง ุชุฌุงุฑ) **ุขุฒุงุฏ ุงุณุช**.

## ๐ค ุณุงุฒูุฏู

ุณุงุฎุชู ุดุฏู ุจุง โค๏ธ ุชูุณุท [power0matin](https://github.com/power0matin) ุจุฑุง ุงููุช ูพุฑูฺูโูุง ุชููู ุฏุฑ ุณุฑูุฑูุง ุฏุงุฎู ุงุฑุงู.
